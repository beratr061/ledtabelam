<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:LEDTabelam.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="400"
             x:Class="LEDTabelam.Views.PreviewPanel"
             x:DataType="vm:PreviewViewModel">

    <UserControl.Styles>
        <!-- Overlay buton stili -->
        <Style Selector="Button.overlay">
            <Setter Property="Background" Value="#80000000"/>
            <Setter Property="Foreground" Value="#FFFFFF"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Opacity" Value="0.7"/>
        </Style>
        <Style Selector="Button.overlay:pointerover">
            <Setter Property="Background" Value="#A0000000"/>
            <Setter Property="Opacity" Value="1"/>
        </Style>
    </UserControl.Styles>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- LED Display Ã–nizleme AlanÄ± -->
        <Border Grid.Row="0" 
                Background="#404040" 
                CornerRadius="8" 
                Margin="4"
                ClipToBounds="True">
            <Grid>
                <!-- Ana Ã¶nizleme alanÄ± - Mouse ile pan iÃ§in event handler'lar -->
                <ScrollViewer x:Name="PreviewScrollViewer"
                              HorizontalScrollBarVisibility="Auto"
                              VerticalScrollBarVisibility="Auto">
                    <Grid HorizontalAlignment="Center" VerticalAlignment="Center"
                          x:Name="PreviewContainer"
                          Cursor="Hand"
                          PointerPressed="OnPreviewPointerPressed"
                          PointerMoved="OnPreviewPointerMoved"
                          PointerReleased="OnPreviewPointerReleased">
                        <!-- LED Display Image -->
                        <Image x:Name="LedDisplayImage"
                               Source="{Binding DisplayBitmap, Converter={x:Static vm:SkiaBitmapToImageConverter.Instance}}"
                               Width="{Binding ScaledWidth}"
                               Height="{Binding ScaledHeight}"
                               Stretch="Fill"
                               RenderOptions.BitmapInterpolationMode="None"
                               UseLayoutRounding="True"/>
                    </Grid>
                </ScrollViewer>
                
                <!-- BoÅŸ Durum (Empty State) - Ä°Ã§erik yoksa gÃ¶ster -->
                <StackPanel HorizontalAlignment="Center" 
                            VerticalAlignment="Center"
                            IsVisible="{Binding DisplayBitmap, Converter={x:Static ObjectConverters.IsNull}}">
                    <TextBlock Text="ðŸ’¡" 
                               FontSize="48" 
                               HorizontalAlignment="Center"
                               Opacity="0.5"/>
                    <TextBlock Text="LED Tabela Ã–nizleme" 
                               Foreground="#808080"
                               FontSize="18"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"
                               Margin="0,8,0,4"/>
                    <TextBlock Text="LÃ¼tfen bir metin girin veya profil seÃ§in" 
                               Foreground="#606060"
                               FontSize="12"
                               HorizontalAlignment="Center"/>
                </StackPanel>
                
                <!-- Overlay Zoom Kontrolleri (SaÄŸ Ã¼st kÃ¶ÅŸe) -->
                <StackPanel Orientation="Horizontal" 
                            Spacing="4"
                            HorizontalAlignment="Right" 
                            VerticalAlignment="Top"
                            Margin="8">
                    <Button Classes="overlay" 
                            Content="+" 
                            Width="32" Height="32"
                            Command="{Binding ZoomInCommand}"
                            ToolTip.Tip="YakÄ±nlaÅŸtÄ±r (Ctrl++)"/>
                    <Button Classes="overlay" 
                            Content="-" 
                            Width="32" Height="32"
                            Command="{Binding ZoomOutCommand}"
                            ToolTip.Tip="UzaklaÅŸtÄ±r (Ctrl+-)"/>
                    <Button Classes="overlay" 
                            Content="âŠ™" 
                            Width="32" Height="32"
                            Command="{Binding FitToWindowCommand}"
                            ToolTip.Tip="Ekrana SÄ±ÄŸdÄ±r"/>
                    <Button Classes="overlay" 
                            Content="100%" 
                            Height="32"
                            Command="{Binding ResetZoomCommand}"
                            ToolTip.Tip="Zoom'u sÄ±fÄ±rla"/>
                </StackPanel>
                
                <!-- Zoom seviyesi gÃ¶stergesi (Sol alt kÃ¶ÅŸe) -->
                <Border Background="#80000000" 
                        CornerRadius="4" 
                        Padding="8,4"
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Bottom"
                        Margin="8"
                        Opacity="0.8">
                    <TextBlock Text="{Binding ZoomLevel, StringFormat='%{0}'}" 
                               Foreground="#FFFFFF"
                               FontSize="12"/>
                </Border>
            </Grid>
        </Border>
        
        <!-- Alt Zoom Kontrolleri (Slider ile detaylÄ± kontrol) -->
        <Border Grid.Row="1" 
                Background="#2D2D2D" 
                CornerRadius="8" 
                Margin="4"
                Padding="12,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Zoom Out Button -->
                <Button Grid.Column="0" 
                        Content="-" 
                        Width="32" 
                        Height="32"
                        Command="{Binding ZoomOutCommand}"
                        ToolTip.Tip="UzaklaÅŸtÄ±r (Ctrl+-)"/>
                
                <!-- Zoom Slider -->
                <Slider Grid.Column="1" 
                        Minimum="50" 
                        Maximum="400" 
                        Value="{Binding ZoomLevel}"
                        Margin="12,0"
                        VerticalAlignment="Center"/>
                
                <!-- Zoom In Button -->
                <Button Grid.Column="2" 
                        Content="+" 
                        Width="32" 
                        Height="32"
                        Command="{Binding ZoomInCommand}"
                        ToolTip.Tip="YakÄ±nlaÅŸtÄ±r (Ctrl++)"/>
                
                <!-- Zoom Level Display + NumericUpDown -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="12,0,0,0">
                    <NumericUpDown Value="{Binding ZoomLevel}" 
                                   Minimum="50" Maximum="400"
                                   Increment="25"
                                   ShowButtonSpinner="False"
                                   Width="60"
                                   FormatString="'{0}%'"
                                   VerticalAlignment="Center"/>
                    <Button Content="SÄ±ÄŸdÄ±r" 
                            Command="{Binding FitToWindowCommand}"
                            Margin="8,0,0,0"
                            ToolTip.Tip="Ekrana SÄ±ÄŸdÄ±r"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>

</UserControl>
