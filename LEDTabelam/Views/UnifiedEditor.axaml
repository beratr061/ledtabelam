<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:LEDTabelam.ViewModels"
             xmlns:models="using:LEDTabelam.Models"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="400"
             x:Class="LEDTabelam.Views.UnifiedEditor"
             x:DataType="vm:UnifiedEditorViewModel">

    <Border Background="#2D2D2D" CornerRadius="8" Padding="8">
        <Grid ColumnDefinitions="240,*,200">
            
            <!-- Sol Panel: Ã–ÄŸe Listesi -->
            <Border Grid.Column="0" Background="#252525" CornerRadius="6" Padding="8" Margin="0,0,4,0">
                <Grid RowDefinitions="Auto,*,Auto">
                    
                    <!-- BaÅŸlÄ±k -->
                    <StackPanel Grid.Row="0" Spacing="6" Margin="0,0,0,8">
                        <Grid ColumnDefinitions="Auto,*,Auto">
                            <TextBlock Grid.Column="0" Text="Program:" Foreground="#B0B0B0" VerticalAlignment="Center" FontSize="11"/>
                            <NumericUpDown Grid.Column="1" Value="{Binding ProgramNumber}" Minimum="1" Maximum="999" 
                                           Width="65" FormatString="000" Margin="6,0" FontSize="11"/>
                            <TextBlock Grid.Column="2" Text="/999" Foreground="#606060" VerticalAlignment="Center" FontSize="11"/>
                        </Grid>
                        <TextBlock Text="Ã–ÄŸeler" FontWeight="SemiBold" Foreground="#E0E0E0" FontSize="12"/>
                    </StackPanel>
                    
                    <!-- Ã–ÄŸe Listesi -->
                    <ListBox Grid.Row="1" 
                             ItemsSource="{Binding Items}" 
                             SelectedItem="{Binding SelectedItem}"
                             Background="Transparent"
                             BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate DataType="models:TabelaItem">
                                <Border Background="{Binding IsSelected, Converter={x:Static vm:BoolToSelectionBrushConverter.Instance}}"
                                        CornerRadius="4" Padding="6,4" Margin="0,1">
                                    <Grid ColumnDefinitions="Auto,Auto,*,Auto">
                                        <TextBlock Grid.Column="0" FontSize="9" Foreground="#808080" 
                                                   VerticalAlignment="Center" Margin="0,0,4,0"
                                                   Text="{Binding ItemType, Converter={x:Static vm:ItemTypeToIconConverter.Instance}}"/>
                                        <Border Grid.Column="1" Width="10" Height="10" CornerRadius="2" Margin="0,0,6,0"
                                                Background="{Binding Color, Converter={x:Static vm:ColorToBrushConverter.Instance}}"/>
                                        <StackPanel Grid.Column="2" Spacing="1">
                                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="10" Foreground="#E0E0E0"/>
                                            <TextBlock FontSize="9" Foreground="#808080" MaxWidth="100" TextTrimming="CharacterEllipsis">
                                                <TextBlock.Text>
                                                    <MultiBinding Converter="{x:Static vm:ItemContentDisplayConverter.Instance}">
                                                        <Binding Path="ItemType"/>
                                                        <Binding Path="Content"/>
                                                        <Binding Path="SymbolName"/>
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </StackPanel>
                                        <TextBlock Grid.Column="3" FontSize="8" Foreground="#606060" VerticalAlignment="Center">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="{}{0},{1}">
                                                    <Binding Path="X"/>
                                                    <Binding Path="Y"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    
                    <!-- Ã–ÄŸe ButonlarÄ± -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="3" Margin="0,6,0,0">
                        <Button Content="+ Metin" Command="{Binding AddTextCommand}" Padding="6,3" FontSize="10"/>
                        <Button Content="+ Sembol" Command="{Binding AddSymbolCommand}" Padding="6,3" FontSize="10"/>
                        <Button Content="Sil" Command="{Binding DeleteItemCommand}" Padding="6,3" FontSize="10"/>
                        <Button Content="Kopyala" Command="{Binding DuplicateCommand}" Padding="6,3" FontSize="10"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Orta Panel: GÃ¶rsel Canvas -->
            <Border Grid.Column="1" Background="#1A1A1A" CornerRadius="6" Margin="4,0" ClipToBounds="True">
                <Grid RowDefinitions="Auto,*,Auto">
                    <!-- Ãœst: Zoom kontrolleri -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="4" Margin="8,6">
                        <TextBlock Text="{Binding DisplaySize}" Foreground="#808080" FontSize="10" VerticalAlignment="Center"/>
                        <Border Width="1" Background="#404040" Margin="8,0"/>
                        <Button Content="-" Width="22" Height="22" Command="{Binding ZoomOutCommand}" FontSize="10"/>
                        <TextBlock Text="{Binding ZoomLevel, StringFormat='{}{0}%'}" Foreground="#E0E0E0" FontSize="10" 
                                   VerticalAlignment="Center" Width="35" TextAlignment="Center"/>
                        <Button Content="+" Width="22" Height="22" Command="{Binding ZoomInCommand}" FontSize="10"/>
                        <Border Width="1" Background="#404040" Margin="8,0"/>
                        <ToggleButton IsChecked="{Binding IsSnapEnabled}" ToolTip.Tip="MÄ±knatÄ±s (Snap)" 
                                      Width="22" Height="22" FontSize="10" Padding="0">
                            <TextBlock Text="ðŸ§²" FontSize="12"/>
                        </ToggleButton>
                        <Border Width="1" Background="#404040" Margin="8,0"/>
                        <ToggleButton IsChecked="{Binding IsAnimationPlaying}" ToolTip.Tip="Animasyonu Oynat/Durdur"
                                      Width="28" Height="22" FontSize="10" Padding="0">
                            <TextBlock Text="â–¶" FontSize="12" Foreground="{Binding IsAnimationPlaying, Converter={x:Static vm:BoolToPlayColorConverter.Instance}}"/>
                        </ToggleButton>
                    </StackPanel>
                    
                    <!-- Canvas AlanÄ± -->
                    <Border Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                            Background="#000000" BorderBrush="#404040" BorderThickness="2"
                            Width="{Binding CanvasWidth}" Height="{Binding CanvasHeight}">
                        <Canvas x:Name="ZoneCanvas" Background="Transparent"
                                PointerPressed="OnCanvasPointerPressed"
                                PointerMoved="OnCanvasPointerMoved"
                                PointerReleased="OnCanvasPointerReleased"/>
                    </Border>
                    
                    <!-- Alt: Koordinat -->
                    <Border Grid.Row="2" Background="#80000000" CornerRadius="4" Padding="6,3" Margin="8,6"
                            HorizontalAlignment="Left">
                        <TextBlock Text="{Binding MousePosition}" Foreground="#FFFFFF" FontSize="9"/>
                    </Border>
                </Grid>
            </Border>
            
            <!-- SaÄŸ Panel: Ã–ÄŸe AyarlarÄ± -->
            <Border Grid.Column="2" Background="#252525" CornerRadius="6" Padding="8" Margin="4,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="8" IsVisible="{Binding HasSelection}">
                        
                        <!-- Ã–ÄŸe AdÄ± -->
                        <StackPanel Spacing="2">
                            <TextBlock Text="Ad" Foreground="#808080" FontSize="10"/>
                            <TextBox Text="{Binding SelectedItem.Name}" FontSize="11"/>
                        </StackPanel>
                        
                        <!-- Ä°Ã§erik (Metin iÃ§in) -->
                        <StackPanel Spacing="2" IsVisible="{Binding IsTextItemSelected}">
                            <TextBlock Text="Ä°Ã§erik" Foreground="#808080" FontSize="10"/>
                            <TextBox Text="{Binding SelectedItem.Content}" FontSize="11" AcceptsReturn="True" 
                                     TextWrapping="Wrap" Height="40"/>
                        </StackPanel>
                        
                        <!-- Font (Metin iÃ§in) -->
                        <StackPanel Spacing="2" IsVisible="{Binding IsTextItemSelected}">
                            <TextBlock Text="Font" Foreground="#808080" FontSize="10"/>
                            <ComboBox ItemsSource="{Binding FontNames}" SelectedItem="{Binding SelectedItem.FontName}"
                                      HorizontalAlignment="Stretch" FontSize="11"/>
                        </StackPanel>
                        
                        <!-- Sembol SeÃ§ici -->
                        <StackPanel Spacing="4" IsVisible="{Binding IsSymbolItemSelected}">
                            <TextBlock Text="Sembol" Foreground="#808080" FontSize="10"/>
                            <ComboBox SelectedIndex="0" SelectionChanged="OnSymbolCategoryChanged" x:Name="SymbolCategoryCombo"
                                      HorizontalAlignment="Stretch" FontSize="10">
                                <ComboBoxItem Content="TÃ¼mÃ¼" Tag="all"/>
                                <ComboBoxItem Content="Bayraklar" Tag="flags"/>
                                <ComboBoxItem Content="EriÅŸilebilirlik" Tag="accessibility"/>
                                <ComboBoxItem Content="YÃ¶n OklarÄ±" Tag="arrows"/>
                                <ComboBoxItem Content="UlaÅŸÄ±m" Tag="transport"/>
                            </ComboBox>
                            <Border Background="#1E1E1E" CornerRadius="4" Padding="2" Height="80">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding FilteredSymbols}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Button Width="32" Height="32" Margin="1" Padding="2"
                                                        ToolTip.Tip="{Binding DisplayName}"
                                                        Click="OnSymbolSelected" Tag="{Binding Name}" Background="#2D2D2D">
                                                    <TextBlock Text="{Binding DisplayName}" FontSize="7" TextWrapping="Wrap"
                                                               TextAlignment="Center" Foreground="#E0E0E0"
                                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                                </Button>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>
                        
                        <Border Height="1" Background="#3D3D3D"/>
                        
                        <!-- Pozisyon ve Boyut -->
                        <TextBlock Text="Pozisyon / Boyut" FontWeight="SemiBold" Foreground="#E0E0E0" FontSize="11"/>
                        <Grid ColumnDefinitions="Auto,*,Auto,*" RowDefinitions="Auto,Auto" Margin="0,4,0,0">
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="X:" Foreground="#808080" FontSize="9" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding SelectedItem.X}" FontSize="10" Margin="0,0,6,2"/>
                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Y:" Foreground="#808080" FontSize="9" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding SelectedItem.Y}" FontSize="10" Margin="0,0,0,2"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="W:" Foreground="#808080" FontSize="9" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedItem.Width}" FontSize="10" Margin="0,2,6,0"/>
                            <TextBlock Grid.Row="1" Grid.Column="2" Text="H:" Foreground="#808080" FontSize="9" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding SelectedItem.Height}" FontSize="10" Margin="0,2,0,0"/>
                        </Grid>
                        
                        <!-- Harf AralÄ±ÄŸÄ± (Metin iÃ§in) -->
                        <StackPanel Spacing="2" IsVisible="{Binding IsTextItemSelected}" Margin="0,4,0,0">
                            <Grid ColumnDefinitions="Auto,*,Auto">
                                <TextBlock Grid.Column="0" Text="Harf AralÄ±ÄŸÄ±:" Foreground="#808080" FontSize="9" VerticalAlignment="Center"/>
                                <Slider Grid.Column="1" Minimum="0" Maximum="10" Value="{Binding SelectedItem.LetterSpacing}" 
                                        Margin="6,0" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                <TextBlock Grid.Column="2" Text="{Binding SelectedItem.LetterSpacing, StringFormat={}{0}px}" 
                                           Foreground="#B0B0B0" FontSize="9" Width="25" VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>
                        
                        <Border Height="1" Background="#3D3D3D"/>
                        
                        <!-- Renk -->
                        <TextBlock Text="Renk" FontWeight="SemiBold" Foreground="#E0E0E0" FontSize="11"/>
                        <WrapPanel Orientation="Horizontal">
                            <Button Width="24" Height="24" Background="#FF0000" Margin="1" Click="OnColorRed"/>
                            <Button Width="24" Height="24" Background="#00FF00" Margin="1" Click="OnColorGreen"/>
                            <Button Width="24" Height="24" Background="#FFB000" Margin="1" Click="OnColorAmber"/>
                            <Button Width="24" Height="24" Background="#FFFFFF" Margin="1" Click="OnColorWhite"/>
                            <Button Width="24" Height="24" Background="#00FFFF" Margin="1" Click="OnColorCyan"/>
                            <Button Width="24" Height="24" Background="#FFFF00" Margin="1" Click="OnColorYellow"/>
                        </WrapPanel>
                        
                        <Border Height="1" Background="#3D3D3D"/>
                        
                        <!-- Hizalama -->
                        <TextBlock Text="Hizalama" FontWeight="SemiBold" Foreground="#E0E0E0" FontSize="11"/>
                        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto">
                            <StackPanel Grid.Column="0" Grid.Row="0" Spacing="2">
                                <TextBlock Text="Yatay" Foreground="#808080" FontSize="9"/>
                                <ComboBox SelectedIndex="{Binding SelectedItem.HAlign, Converter={x:Static vm:HAlignToIndexConverter.Instance}}"
                                          SelectionChanged="OnHAlignChanged" HorizontalAlignment="Stretch" FontSize="10">
                                    <ComboBoxItem Content="Sol"/>
                                    <ComboBoxItem Content="Orta"/>
                                    <ComboBoxItem Content="SaÄŸ"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Grid.Row="0" Spacing="2" Margin="4,0,0,0">
                                <TextBlock Text="Dikey" Foreground="#808080" FontSize="9"/>
                                <ComboBox SelectedIndex="{Binding SelectedItem.VAlign, Converter={x:Static vm:VAlignToIndexConverter.Instance}}"
                                          SelectionChanged="OnVAlignChanged" HorizontalAlignment="Stretch" FontSize="10">
                                    <ComboBoxItem Content="Ãœst"/>
                                    <ComboBoxItem Content="Orta"/>
                                    <ComboBoxItem Content="Alt"/>
                                </ComboBox>
                            </StackPanel>
                        </Grid>
                        
                        <Border Height="1" Background="#3D3D3D"/>
                        
                        <!-- Kayan YazÄ± -->
                        <CheckBox Content="Kayan YazÄ±" IsChecked="{Binding SelectedItem.IsScrolling}" FontSize="11"
                                  IsVisible="{Binding IsTextItemSelected}"/>
                        <StackPanel Spacing="4" IsVisible="{Binding IsScrollingItemSelected}">
                            <Grid ColumnDefinitions="*,*">
                                <StackPanel Grid.Column="0" Spacing="2" Margin="0,0,2,0">
                                    <TextBlock Text="YÃ¶n" Foreground="#808080" FontSize="9"/>
                                    <ComboBox SelectedIndex="{Binding SelectedItem.ScrollDirection, Converter={x:Static vm:ScrollDirToIndexConverter.Instance}}"
                                              HorizontalAlignment="Stretch" FontSize="10">
                                        <ComboBoxItem Content="â† Sol"/>
                                        <ComboBoxItem Content="â†’ SaÄŸ"/>
                                        <ComboBoxItem Content="â†‘ YukarÄ±"/>
                                        <ComboBoxItem Content="â†“ AÅŸaÄŸÄ±"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Spacing="2" Margin="2,0,0,0">
                                    <TextBlock Text="HÄ±z" Foreground="#808080" FontSize="9"/>
                                    <Slider Minimum="1" Maximum="100" Value="{Binding SelectedItem.ScrollSpeed}" 
                                            TickFrequency="10" IsSnapToTickEnabled="False"/>
                                </StackPanel>
                            </Grid>
                            <Border Background="#1E3A1E" CornerRadius="4" Padding="6,4">
                                <TextBlock Text="â–¶ YukarÄ±daki play butonuna tÄ±klayÄ±n" Foreground="#80FF80" FontSize="9" 
                                           HorizontalAlignment="Center"/>
                            </Border>
                        </StackPanel>
                        
                    </StackPanel>
                </ScrollViewer>
            </Border>
            
        </Grid>
    </Border>

</UserControl>
