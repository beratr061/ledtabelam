<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:LEDTabelam.Maui.ViewModels"
             x:Class="LEDTabelam.Maui.Controls.EditorPanel"
             x:DataType="vm:EditorViewModel">

    <!-- 3 SÃ¼tunlu Layout: Sol (Pozisyon/Boyut), Orta (Canvas), SaÄŸ (Metin/Renk) -->
    <Grid ColumnDefinitions="180,*,200" Background="#1A1A1A">
        
        <!-- Sol SÃ¼tun: Pozisyon, Boyut, Hizalama -->
        <Border Grid.Column="0" BackgroundColor="#252525" Margin="2" Padding="8">
            <ScrollView>
                <VerticalStackLayout Spacing="12" IsVisible="{Binding HasEditingContent}">
                    
                    <!-- Pozisyon -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="POZÄ°SYON" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <Grid ColumnDefinitions="24,*" RowDefinitions="Auto,Auto" ColumnSpacing="4" RowSpacing="4">
                            <Label Grid.Row="0" Grid.Column="0" Text="X:" TextColor="#B0B0B0" FontSize="10" VerticalOptions="Center"/>
                            <Entry Grid.Row="0" Grid.Column="1" Text="{Binding PositionX}" BackgroundColor="#2D2D2D" TextColor="#E0E0E0"
                                   Keyboard="Numeric" FontSize="11" HeightRequest="28"/>
                            <Label Grid.Row="1" Grid.Column="0" Text="Y:" TextColor="#B0B0B0" FontSize="10" VerticalOptions="Center"/>
                            <Entry Grid.Row="1" Grid.Column="1" Text="{Binding PositionY}" BackgroundColor="#2D2D2D" TextColor="#E0E0E0"
                                   Keyboard="Numeric" FontSize="11" HeightRequest="28"/>
                        </Grid>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D"/>
                    
                    <!-- Boyut -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="BOYUT" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <Grid ColumnDefinitions="24,*" RowDefinitions="Auto,Auto" ColumnSpacing="4" RowSpacing="4">
                            <Label Grid.Row="0" Grid.Column="0" Text="W:" TextColor="#B0B0B0" FontSize="10" VerticalOptions="Center"/>
                            <Entry Grid.Row="0" Grid.Column="1" Text="{Binding ContentWidth}" BackgroundColor="#2D2D2D" TextColor="#E0E0E0"
                                   Keyboard="Numeric" FontSize="11" HeightRequest="28"/>
                            <Label Grid.Row="1" Grid.Column="0" Text="H:" TextColor="#B0B0B0" FontSize="10" VerticalOptions="Center"/>
                            <Entry Grid.Row="1" Grid.Column="1" Text="{Binding ContentHeight}" BackgroundColor="#2D2D2D" TextColor="#E0E0E0"
                                   Keyboard="Numeric" FontSize="11" HeightRequest="28"/>
                        </Grid>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D"/>

                    <!-- Yatay Hizalama -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="YATAY HÄ°ZALAMA" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <HorizontalStackLayout Spacing="2">
                            <Button Text="â—€" 
                                    BackgroundColor="{Binding HorizontalAlignment, Converter={StaticResource HAlignToLeftColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding AlignLeftCommand}"
                                    WidthRequest="36" HeightRequest="28" Padding="0" FontSize="10"/>
                            <Button Text="â—†" 
                                    BackgroundColor="{Binding HorizontalAlignment, Converter={StaticResource HAlignToCenterColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding AlignCenterCommand}"
                                    WidthRequest="36" HeightRequest="28" Padding="0" FontSize="10"/>
                            <Button Text="â–¶" 
                                    BackgroundColor="{Binding HorizontalAlignment, Converter={StaticResource HAlignToRightColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding AlignRightCommand}"
                                    WidthRequest="36" HeightRequest="28" Padding="0" FontSize="10"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                    
                    <!-- Dikey Hizalama -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="DÄ°KEY HÄ°ZALAMA" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <HorizontalStackLayout Spacing="2">
                            <Button Text="â–²" 
                                    BackgroundColor="{Binding VerticalAlignment, Converter={StaticResource VAlignToTopColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding AlignTopCommand}"
                                    WidthRequest="36" HeightRequest="28" Padding="0" FontSize="10"/>
                            <Button Text="â—" 
                                    BackgroundColor="{Binding VerticalAlignment, Converter={StaticResource VAlignToMiddleColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding AlignMiddleCommand}"
                                    WidthRequest="36" HeightRequest="28" Padding="0" FontSize="10"/>
                            <Button Text="â–¼" 
                                    BackgroundColor="{Binding VerticalAlignment, Converter={StaticResource VAlignToBottomColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding AlignBottomCommand}"
                                    WidthRequest="36" HeightRequest="28" Padding="0" FontSize="10"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D"/>
                    
                    <!-- Zoom Kontrolleri -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="ZOOM" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <HorizontalStackLayout Spacing="4">
                            <Button Text="âˆ’" BackgroundColor="#3D3D3D" TextColor="#E0E0E0"
                                    Clicked="OnZoomOut" WidthRequest="28" HeightRequest="28" Padding="0" FontSize="12"/>
                            <Label x:Name="ZoomLabel" Text="100%" TextColor="#E0E0E0" FontSize="10" 
                                   VerticalOptions="Center" WidthRequest="40" HorizontalTextAlignment="Center"/>
                            <Button Text="+" BackgroundColor="#3D3D3D" TextColor="#E0E0E0"
                                    Clicked="OnZoomIn" WidthRequest="28" HeightRequest="28" Padding="0" FontSize="12"/>
                        </HorizontalStackLayout>
                        <HorizontalStackLayout Spacing="4" Margin="0,4,0,0">
                            <CheckBox x:Name="SnapCheckBox" Color="#4A6FA5" IsChecked="True" VerticalOptions="Center"/>
                            <Label Text="Snap" TextColor="#B0B0B0" FontSize="10" VerticalOptions="Center"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                    
                </VerticalStackLayout>
            </ScrollView>
        </Border>

        <!-- Orta SÃ¼tun: Canvas EditÃ¶r -->
        <Border Grid.Column="1" BackgroundColor="#0D0D0D" Margin="2">
            <Grid>
                <!-- Canvas Container -->
                <ScrollView x:Name="CanvasScrollView" 
                            HorizontalScrollBarVisibility="Always" 
                            VerticalScrollBarVisibility="Always">
                    <Grid HorizontalOptions="Center" VerticalOptions="Center" Padding="20">
                        <!-- LED Display Canvas -->
                        <Border x:Name="CanvasBorder"
                                BackgroundColor="#000000" 
                                Stroke="#404040" 
                                StrokeThickness="2"
                                StrokeShape="RoundRectangle 2">
                            <Grid x:Name="CanvasContainer">
                                <!-- Items Canvas - AbsoluteLayout for free positioning -->
                                <AbsoluteLayout x:Name="ItemsCanvas" 
                                                ZIndex="1"
                                                Background="Transparent"/>
                                
                                <!-- Touch/Mouse Handler -->
                                <Grid x:Name="InputHandler" 
                                      ZIndex="3"
                                      Background="Transparent">
                                    <Grid.GestureRecognizers>
                                        <PointerGestureRecognizer PointerPressed="OnCanvasPointerPressed"
                                                                  PointerMoved="OnCanvasPointerMoved"
                                                                  PointerReleased="OnCanvasPointerReleased"/>
                                        <TapGestureRecognizer Tapped="OnCanvasTapped"/>
                                    </Grid.GestureRecognizers>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                </ScrollView>
                
                <!-- Koordinat ve Boyut GÃ¶stergesi (Sol Alt) -->
                <Border BackgroundColor="#80000000" 
                        StrokeShape="RoundRectangle 4"
                        Padding="6,3"
                        HorizontalOptions="Start"
                        VerticalOptions="End"
                        Margin="8">
                    <HorizontalStackLayout Spacing="8">
                        <Label x:Name="CoordinateLabel" Text="X: 0, Y: 0" TextColor="#FFFFFF" FontSize="9"/>
                        <Label x:Name="DisplaySizeLabel" Text="128 x 32" TextColor="#808080" FontSize="9"/>
                    </HorizontalStackLayout>
                </Border>
                
                <!-- SeÃ§ili Ã–ÄŸe Bilgisi (SaÄŸ Alt) -->
                <Border BackgroundColor="#80000000" 
                        StrokeShape="RoundRectangle 4"
                        Padding="6,3"
                        HorizontalOptions="End"
                        VerticalOptions="End"
                        Margin="8"
                        IsVisible="{Binding HasEditingContent}">
                    <Label Text="{Binding EditingContent.Name, StringFormat='SeÃ§ili: {0}'}" 
                           TextColor="#B0B0B0" FontSize="9"/>
                </Border>
                
                <!-- No Content Overlay -->
                <VerticalStackLayout IsVisible="{Binding HasEditingContent, Converter={StaticResource InverseBoolConverter}}"
                                     VerticalOptions="Center" HorizontalOptions="Center" Spacing="8">
                    <Label Text="ðŸ–¼" FontSize="48" HorizontalOptions="Center" TextColor="#303030"/>
                    <Label Text="Ä°Ã§erik seÃ§in" TextColor="#505050" FontSize="12"/>
                </VerticalStackLayout>
            </Grid>
        </Border>

        <!-- SaÄŸ SÃ¼tun: Metin, Font, Renk -->
        <Border Grid.Column="2" BackgroundColor="#252525" Margin="2" Padding="8">
            <ScrollView>
                <VerticalStackLayout Spacing="12" IsVisible="{Binding HasEditingContent}">
                    
                    <!-- Metin GiriÅŸi (Sadece metin iÃ§eriÄŸi iÃ§in) -->
                    <VerticalStackLayout Spacing="4" IsVisible="{Binding IsTextContent}">
                        <Label Text="METÄ°N" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <Editor Text="{Binding Text}"
                                BackgroundColor="#2D2D2D"
                                TextColor="#E0E0E0"
                                Placeholder="Metin girin..."
                                PlaceholderColor="#606060"
                                FontSize="12"
                                HeightRequest="60"
                                AutoSize="TextChanges"/>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D" IsVisible="{Binding IsTextContent}"/>
                    
                    <!-- Font AyarlarÄ± -->
                    <VerticalStackLayout Spacing="4" IsVisible="{Binding IsTextContent}">
                        <Label Text="FONT" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <Picker BackgroundColor="#2D2D2D" TextColor="#E0E0E0"
                                ItemsSource="{Binding AvailableFonts}"
                                SelectedItem="{Binding SelectedFont}"
                                FontSize="10" HeightRequest="32"/>
                        <HorizontalStackLayout Spacing="4" Margin="0,4,0,0">
                            <Button Text="âˆ’" BackgroundColor="#3D3D3D" TextColor="#E0E0E0"
                                    Command="{Binding DecreaseFontSizeCommand}"
                                    WidthRequest="28" HeightRequest="28" Padding="0" FontSize="12"/>
                            <Label Text="{Binding FontSize}" TextColor="#E0E0E0" FontSize="11" 
                                   VerticalOptions="Center" WidthRequest="30" HorizontalTextAlignment="Center"/>
                            <Button Text="+" BackgroundColor="#3D3D3D" TextColor="#E0E0E0"
                                    Command="{Binding IncreaseFontSizeCommand}"
                                    WidthRequest="28" HeightRequest="28" Padding="0" FontSize="12"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D" IsVisible="{Binding IsTextContent}"/>
                    
                    <!-- Stil -->
                    <VerticalStackLayout Spacing="4" IsVisible="{Binding IsTextContent}">
                        <Label Text="STÄ°L" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <HorizontalStackLayout Spacing="2">
                            <Button Text="B" FontAttributes="Bold"
                                    BackgroundColor="{Binding IsBold, Converter={StaticResource BoolToSelectedColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding ToggleBoldCommand}"
                                    WidthRequest="32" HeightRequest="28" Padding="0" FontSize="11"/>
                            <Button Text="I" FontAttributes="Italic"
                                    BackgroundColor="{Binding IsItalic, Converter={StaticResource BoolToSelectedColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding ToggleItalicCommand}"
                                    WidthRequest="32" HeightRequest="28" Padding="0" FontSize="11"/>
                            <Button Text="UÌ²"
                                    BackgroundColor="{Binding IsUnderline, Converter={StaticResource BoolToSelectedColorConverter}}"
                                    TextColor="#E0E0E0" Command="{Binding ToggleUnderlineCommand}"
                                    WidthRequest="32" HeightRequest="28" Padding="0" FontSize="11"/>
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D"/>

                    <!-- Renk -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="RENK" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <FlexLayout Wrap="Wrap" JustifyContent="Start">
                            <Button BackgroundColor="#FFB000" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Amber"/>
                            <Button BackgroundColor="#00FF00" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Green"/>
                            <Button BackgroundColor="#FF0000" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Red"/>
                            <Button BackgroundColor="#00FFFF" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Cyan"/>
                            <Button BackgroundColor="#FFFF00" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Yellow"/>
                            <Button BackgroundColor="#FFFFFF" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="White"/>
                            <Button BackgroundColor="#FF00FF" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Magenta"/>
                            <Button BackgroundColor="#0080FF" WidthRequest="28" HeightRequest="28" CornerRadius="4" Margin="1"
                                    Clicked="OnPresetForegroundColorClicked" ClassId="Blue"/>
                        </FlexLayout>
                    </VerticalStackLayout>
                    
                    <BoxView HeightRequest="1" BackgroundColor="#3D3D3D" IsVisible="{Binding IsTextContent}"/>
                    
                    <!-- Kayan YazÄ± -->
                    <VerticalStackLayout Spacing="4" IsVisible="{Binding IsTextContent}">
                        <Label Text="KAYAN YAZI" TextColor="#808080" FontSize="9" FontAttributes="Bold"/>
                        <HorizontalStackLayout Spacing="4">
                            <CheckBox Color="#4A6FA5" IsChecked="{Binding IsScrolling}" VerticalOptions="Center"/>
                            <Label Text="Aktif" TextColor="#B0B0B0" FontSize="10" VerticalOptions="Center"/>
                        </HorizontalStackLayout>
                        <VerticalStackLayout Spacing="2" IsVisible="{Binding IsScrolling}">
                            <Label Text="HÄ±z:" TextColor="#808080" FontSize="9"/>
                            <Slider Minimum="1" Maximum="100" Value="{Binding ScrollSpeed}"
                                    ThumbColor="#4A6FA5" MinimumTrackColor="#4A6FA5"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                    
                </VerticalStackLayout>
            </ScrollView>
        </Border>
        
    </Grid>
</ContentView>
